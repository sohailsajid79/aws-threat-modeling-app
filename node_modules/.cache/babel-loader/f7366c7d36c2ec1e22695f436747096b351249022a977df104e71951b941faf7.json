{"ast":null,"code":"import{useCallback,useEffect,useState}from'react';import ReactFlow,{Controls,Background,addEdge,useEdgesState,useNodesState,ConnectionMode,Panel,useReactFlow,applyEdgeChanges,applyNodeChanges,MarkerType}from'reactflow';import styled from'@emotion/styled';import Container from'@cloudscape-design/components/container';import Header from'@cloudscape-design/components/header';import SpaceBetween from'@cloudscape-design/components/space-between';import{v4}from'uuid';import'reactflow/dist/style.css';import ActorNode from'./Nodes/ActorNode';import DatastoreNode from'./Nodes/DatastoreNode';import ProcessNode from'./Nodes/ProcessNode';import TrustBoundaryNode from'./Nodes/TrustBoundaryNode';import NodeSelector from'./Nodes/NodeSelector';import BiDirectionalEdge from'./Edges/BiDirectionalEdge';import PropertiesPanel from'./Properties/PropertiesPanel';import SaveButton from'./SaveButton/SaveButton';import ZIndexChanger from'./Nodes/ZIndexChanger';import ThreatList from'./Threats/ThreatList';import{useFlowContext,useThreatsContext}from'../../../contexts';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const edgeTypes={biDirectional:BiDirectionalEdge};const nodeTypes={actor:ActorNode,datastore:DatastoreNode,process:ProcessNode,trustBoundary:TrustBoundaryNode};let s;(function(_s){const OuterContainer=_s.OuterContainer=styled.div`\n    height: 450px;\n    display: flex;\n    border: 1px solid #000;\n\n     svg.react-flow__edges {\n      z-index: 1 !important;\n     }\n  `;})(s||(s={}));function Flow(){const{zoomTo,getZoom,setViewport}=useReactFlow();// Save and restore state\nconst[rfInstance,setRfInstance]=useState(null);const[saveState,setSaveState]=useState(true);const[nodes,setNodes]=useNodesState([]);const[edges,setEdges]=useEdgesState([]);const{flow,setFlow}=useFlowContext();const onSave=useCallback(()=>{if(rfInstance){setFlow({content:JSON.stringify(rfInstance.toObject())});setSaveState(true);}},[rfInstance,setFlow]);const restoreFlow=useCallback(async()=>{if(flow.content){const diagram=JSON.parse(flow.content||'{}');const{x=0,y=0,zoom=1}=diagram.viewport;setNodes(diagram.nodes||[]);setEdges(diagram.edges||[]);setViewport({x,y,zoom});}},[flow.content,setNodes,setEdges,setViewport]);useEffect(()=>{restoreFlow().catch(console.error);},[flow.content,restoreFlow]);const onInit=async instance=>{setRfInstance(instance);await restoreFlow();};// Nodes and edges state\nconst[nodeDataValue,setNodeDataValue]=useState({});const[selectedComponent,setSelectedComponent]=useState(null);useEffect(()=>{if(!selectedComponent){// If this is the first node added to the flow, zoom out to prevent an implicit max zoom (of 4)\n// this is probably another bug in react-flow that needs to be investigated and reported\nif(nodes.length===1&&getZoom()===4){zoomTo(1);}return;}setEdges(eds=>eds.map(edge=>{if(edge.id===(selectedComponent===null||selectedComponent===void 0?void 0:selectedComponent.id)){edge.data={...edge.data,...nodeDataValue};}return edge;}));setNodes(nds=>nds.map(node=>{if(node.id===(selectedComponent===null||selectedComponent===void 0?void 0:selectedComponent.id)){node.data={...node.data,...nodeDataValue};}return node;}));setSaveState(false);},[selectedComponent,nodeDataValue,setNodes,setEdges,getZoom,zoomTo,nodes.length]);const onNodesChange=useCallback(changes=>{setNodeDataValue({});setNodes(oldNodes=>applyNodeChanges(changes,oldNodes));for(let selection of changes.filter(c=>c.type==='select'||c.type==='position'&&c.dragging===false||c.type==='remove')){if(selection.selected||selection.dragging===false){setSelectedComponent(nodes.find(node=>node.id===selection.id));}else{setSelectedComponent(null);}};},[nodes,setNodes]);const onEdgesChange=useCallback(changes=>{setNodeDataValue({});setEdges(oldEdges=>applyEdgeChanges(changes,oldEdges));setSelectedComponent(null);for(let selection of changes.filter(c=>c.type==='select')){if(selection.selected){setSelectedComponent(edges.find(edge=>edge.id===selection.id));}else{setSelectedComponent(null);}}},[edges,setEdges]);const onConnect=useCallback(params=>{const newEdge={...params,id:v4(),type:'biDirectional',data:{name:'Data',description:'',outOfScope:false,scopeReason:'',dataTags:[],techTags:[],securityTags:[],tags:[],selectedThreats:[]}};setEdges(eds=>addEdge(addEndMarker(newEdge),eds));setNodeDataValue({});},[setEdges]);const onAdd=useCallback(type=>{setNodes(nds=>{// Randomize position for new nodes using a position from -100 to 100\nlet x=Math.floor(Math.random()*200)-100;let y=Math.floor(Math.random()*200)-100;const newNode={id:v4(),data:{name:type,description:'',outOfScope:false,scopeReason:'',dataTags:[],techTags:[],securityTags:[],tags:[],selectedThreats:[]},type,position:{x,y}};setSaveState(false);return[...nds,newNode];});},[setNodes]);const onZIndexChange=useCallback(direction=>{setNodes(nds=>{const selectedNode=nds.find(node=>node.id===(selectedComponent===null||selectedComponent===void 0?void 0:selectedComponent.id));if(!selectedNode){return nds;}const index=nds.indexOf(selectedNode);const newIndex=direction==='last'?0:direction==='down'?index-1:direction==='up'?index+1:nds.length-1;const node=nds.splice(index,1)[0];nds.splice(newIndex,0,node);setSaveState(false);return[...nds];});},[setNodes,selectedComponent]);// Threats state\nconst{statementList}=useThreatsContext();const[threatList,setThreatList]=useState(statementList);useEffect(()=>{// update list of threats panel\nsetThreatList(statementList);},[setThreatList,statementList]);const addEndMarker=edge=>({...edge,markerEnd:{type:MarkerType.ArrowClosed,width:20,height:20,color:'#b1b1b7'}});return/*#__PURE__*/_jsxs(SpaceBetween,{direction:\"vertical\",size:\"s\",children:[/*#__PURE__*/_jsx(Container,{header:/*#__PURE__*/_jsx(Header,{actions:/*#__PURE__*/_jsx(SaveButton,{saveHandler:onSave,saveState:saveState}),children:\"Data flow diagram\"}),children:/*#__PURE__*/_jsx(s.OuterContainer,{children:/*#__PURE__*/_jsxs(ReactFlow,{nodes:nodes,onNodesChange:onNodesChange,edges:edges,onEdgesChange:onEdgesChange,onConnect:onConnect,edgeTypes:edgeTypes,nodeTypes:nodeTypes,minZoom:0.2,maxZoom:4,fitView:true,connectionMode:ConnectionMode.Loose,onInit:onInit,children:[/*#__PURE__*/_jsx(Background,{}),/*#__PURE__*/_jsx(Controls,{}),/*#__PURE__*/_jsx(Panel,{position:\"top-left\",children:/*#__PURE__*/_jsx(NodeSelector,{addCallback:onAdd})}),/*#__PURE__*/_jsx(Panel,{position:\"top-right\",children:/*#__PURE__*/_jsx(ZIndexChanger,{addCallback:onZIndexChange})})]})})}),/*#__PURE__*/_jsx(Container,{header:/*#__PURE__*/_jsx(Header,{children:\"Properties\"}),children:/*#__PURE__*/_jsx(PropertiesPanel,{component:selectedComponent,changeHandler:setNodeDataValue})}),/*#__PURE__*/_jsx(ThreatList,{threats:threatList,component:selectedComponent,changeHandler:setNodeDataValue})]});}export default Flow;","map":{"version":3,"names":["useCallback","useEffect","useState","ReactFlow","Controls","Background","addEdge","useEdgesState","useNodesState","ConnectionMode","Panel","useReactFlow","applyEdgeChanges","applyNodeChanges","MarkerType","styled","Container","Header","SpaceBetween","v4","ActorNode","DatastoreNode","ProcessNode","TrustBoundaryNode","NodeSelector","BiDirectionalEdge","PropertiesPanel","SaveButton","ZIndexChanger","ThreatList","useFlowContext","useThreatsContext","jsx","_jsx","jsxs","_jsxs","edgeTypes","biDirectional","nodeTypes","actor","datastore","process","trustBoundary","s","_s","OuterContainer","div","Flow","zoomTo","getZoom","setViewport","rfInstance","setRfInstance","saveState","setSaveState","nodes","setNodes","edges","setEdges","flow","setFlow","onSave","content","JSON","stringify","toObject","restoreFlow","diagram","parse","x","y","zoom","viewport","catch","console","error","onInit","instance","nodeDataValue","setNodeDataValue","selectedComponent","setSelectedComponent","length","eds","map","edge","id","data","nds","node","onNodesChange","changes","oldNodes","selection","filter","c","type","dragging","selected","find","onEdgesChange","oldEdges","onConnect","params","newEdge","name","description","outOfScope","scopeReason","dataTags","techTags","securityTags","tags","selectedThreats","addEndMarker","onAdd","Math","floor","random","newNode","position","onZIndexChange","direction","selectedNode","index","indexOf","newIndex","splice","statementList","threatList","setThreatList","markerEnd","ArrowClosed","width","height","color","size","children","header","actions","saveHandler","minZoom","maxZoom","fitView","connectionMode","Loose","addCallback","component","changeHandler","threats"],"sources":["/Users/sohailsajid/Desktop/threat-modeling-app/src/components/generic/Flow/index.tsx"],"sourcesContent":["import { useCallback, useEffect, useState } from 'react';\nimport ReactFlow, {\n  Controls,\n  Background,\n  addEdge,\n  useEdgesState,\n  useNodesState,\n  ConnectionMode,\n  Panel,\n  Node,\n  Edge,\n  ReactFlowInstance,\n  useReactFlow,\n  applyEdgeChanges,\n  applyNodeChanges,\n  MarkerType,\n} from 'reactflow';\nimport styled from '@emotion/styled';\nimport Container from '@cloudscape-design/components/container';\nimport Header from '@cloudscape-design/components/header';\nimport SpaceBetween from '@cloudscape-design/components/space-between';\nimport { v4 } from 'uuid';\nimport 'reactflow/dist/style.css';\n\nimport ActorNode from './Nodes/ActorNode';\nimport DatastoreNode from './Nodes/DatastoreNode';\nimport ProcessNode from './Nodes/ProcessNode';\nimport TrustBoundaryNode from './Nodes/TrustBoundaryNode';\nimport NodeSelector from './Nodes/NodeSelector';\n\nimport BiDirectionalEdge from './Edges/BiDirectionalEdge';\n\nimport PropertiesPanel from './Properties/PropertiesPanel';\nimport SaveButton from './SaveButton/SaveButton';\nimport ZIndexChanger from './Nodes/ZIndexChanger';\n\nimport ThreatList from './Threats/ThreatList';\n\nimport { useFlowContext, useThreatsContext } from '../../../contexts';\n\nconst edgeTypes = {\n  biDirectional: BiDirectionalEdge,\n};\n\nconst nodeTypes = {\n  actor: ActorNode,\n  datastore: DatastoreNode,\n  process: ProcessNode,\n  trustBoundary: TrustBoundaryNode,\n};\n\nnamespace s {\n  export const OuterContainer = styled.div`\n    height: 450px;\n    display: flex;\n    border: 1px solid #000;\n\n     svg.react-flow__edges {\n      z-index: 1 !important;\n     }\n  `;\n}\n\nfunction Flow() {\n  const { zoomTo, getZoom, setViewport } = useReactFlow();\n\n  // Save and restore state\n  const [rfInstance, setRfInstance] = useState<ReactFlowInstance<any, any> | null>(null);\n  const [saveState, setSaveState] = useState(true);\n  const [nodes, setNodes] = useNodesState([]);\n  const [edges, setEdges] = useEdgesState([]);\n\n  const { flow, setFlow } = useFlowContext();\n\n  const onSave = useCallback(() => {\n    if (rfInstance) {\n      setFlow({ content: JSON.stringify(rfInstance.toObject()) });\n      setSaveState(true);\n    }\n  }, [rfInstance, setFlow]);\n\n  const restoreFlow = useCallback(async () => {\n    if (flow.content) {\n      const diagram = JSON.parse(flow.content || '{}');\n      const { x = 0, y = 0, zoom = 1 } = diagram.viewport;\n      setNodes(diagram.nodes || []);\n      setEdges(diagram.edges || []);\n      setViewport({ x, y, zoom });\n    }\n  }, [flow.content, setNodes, setEdges, setViewport]);\n\n  useEffect(() => {\n    restoreFlow().catch(console.error);\n  }, [flow.content, restoreFlow]);\n\n  const onInit = async (instance) => {\n    setRfInstance(instance);\n    await restoreFlow();\n  };\n\n  // Nodes and edges state\n  const [nodeDataValue, setNodeDataValue] = useState({});\n  const [selectedComponent, setSelectedComponent] = useState<Node | Edge | null>(null);\n\n  useEffect(() => {\n    if (!selectedComponent) {\n      // If this is the first node added to the flow, zoom out to prevent an implicit max zoom (of 4)\n      // this is probably another bug in react-flow that needs to be investigated and reported\n      if (nodes.length === 1 && getZoom() === 4) {\n        zoomTo(1);\n      }\n      return;\n    }\n\n    setEdges((eds) =>\n      eds.map((edge) => {\n        if (edge.id === selectedComponent?.id) {\n          edge.data = { ...edge.data, ...nodeDataValue };\n        }\n        return edge;\n      }));\n    setNodes((nds) =>\n      nds.map((node) => {\n        if (node.id === selectedComponent?.id) {\n          node.data = { ...node.data, ...nodeDataValue };\n        }\n        return node;\n      }));\n    setSaveState(false);\n  }, [selectedComponent, nodeDataValue, setNodes, setEdges, getZoom, zoomTo, nodes.length]);\n\n  const onNodesChange = useCallback(\n    (changes) => {\n      setNodeDataValue({});\n      setNodes((oldNodes) => applyNodeChanges(changes, oldNodes));\n      for (let selection of changes.filter(c => c.type === 'select' || (c.type === 'position' && c.dragging === false) || c.type ==='remove')) {\n        if (selection.selected || selection.dragging === false) {\n          setSelectedComponent(nodes.find((node) => node.id === selection.id) as Node | null);\n        } else {\n          setSelectedComponent(null);\n        }\n      };\n    },\n    [nodes, setNodes],\n  );\n\n  const onEdgesChange = useCallback(\n    (changes) => {\n      setNodeDataValue({});\n      setEdges((oldEdges) => applyEdgeChanges(changes, oldEdges));\n      setSelectedComponent(null);\n      for (let selection of changes.filter(c => c.type === 'select')) {\n        if (selection.selected) {\n          setSelectedComponent(edges.find((edge) => edge.id === selection.id) as Edge | null);\n        } else {\n          setSelectedComponent(null);\n        }\n      }\n    },\n    [edges, setEdges],\n  );\n\n  const onConnect = useCallback(\n    (params) => {\n      const newEdge =\n      {\n        ...params,\n        id: v4(),\n        type: 'biDirectional',\n        data: {\n          name: 'Data',\n          description: '',\n          outOfScope: false,\n          scopeReason: '',\n          dataTags: [],\n          techTags: [],\n          securityTags: [],\n          tags: [],\n          selectedThreats: [],\n        },\n      };\n      setEdges((eds) => addEdge(addEndMarker(newEdge), eds));\n      setNodeDataValue({});\n    }, [setEdges],\n  );\n\n  const onAdd = useCallback((type: string) => {\n    setNodes((nds) => {\n      // Randomize position for new nodes using a position from -100 to 100\n      let x = Math.floor(Math.random() * 200) - 100;\n      let y = Math.floor(Math.random() * 200) - 100;\n\n      const newNode = {\n        id: v4(),\n        data: {\n          name: type,\n          description: '',\n          outOfScope: false,\n          scopeReason: '',\n          dataTags: [],\n          techTags: [],\n          securityTags: [],\n          tags: [],\n          selectedThreats: [],\n        },\n        type,\n        position: { x, y },\n      };\n      setSaveState(false);\n      return [...nds, newNode];\n    });\n  }, [setNodes]);\n\n  const onZIndexChange = useCallback((direction: string) => {\n    setNodes((nds) => {\n      const selectedNode = nds.find((node) => node.id === selectedComponent?.id);\n      if (!selectedNode) {\n        return nds;\n      }\n      const index = nds.indexOf(selectedNode);\n      const newIndex = direction === 'last' ? 0 : direction === 'down' ? index - 1 : direction === 'up' ? index + 1 : nds.length - 1;\n      const node = nds.splice(index, 1)[0];\n      nds.splice(newIndex, 0, node);\n      setSaveState(false);\n      return [...nds];\n    });\n  }, [setNodes, selectedComponent]);\n\n  // Threats state\n  const { statementList } = useThreatsContext();\n  const [threatList, setThreatList] = useState(statementList);\n\n  useEffect(() => { // update list of threats panel\n    setThreatList(statementList);\n  }, [setThreatList, statementList]);\n\n  const addEndMarker = (edge) => ({\n    ...edge,\n    markerEnd: {\n      type: MarkerType.ArrowClosed,\n      width: 20,\n      height: 20,\n      color: '#b1b1b7',\n    },\n  });\n\n  return (\n    <SpaceBetween direction=\"vertical\" size=\"s\">\n      <Container header={<Header actions={<SaveButton saveHandler={onSave} saveState={saveState} />}>Data flow diagram</Header>}>\n        <s.OuterContainer>\n          <ReactFlow\n            nodes={nodes}\n            onNodesChange={onNodesChange}\n            edges={edges}\n            onEdgesChange={onEdgesChange}\n            onConnect={onConnect}\n            edgeTypes={edgeTypes}\n            nodeTypes={nodeTypes}\n            minZoom={0.2}\n            maxZoom={4}\n            fitView\n            connectionMode={ConnectionMode.Loose}\n            onInit={onInit}\n          >\n            <Background />\n            <Controls />\n            <Panel position=\"top-left\"><NodeSelector addCallback={onAdd} /></Panel>\n            <Panel position=\"top-right\"><ZIndexChanger addCallback={onZIndexChange} /></Panel>\n          </ReactFlow>\n        </s.OuterContainer>\n      </Container>\n      <Container header={<Header>Properties</Header>}>\n        <PropertiesPanel component={selectedComponent} changeHandler={setNodeDataValue} />\n      </Container>\n      <ThreatList\n        threats={threatList}\n        component={selectedComponent}\n        changeHandler={setNodeDataValue} />\n    </SpaceBetween>\n  );\n}\n\nexport default Flow;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}