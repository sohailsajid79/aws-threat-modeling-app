{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { useEffect, useState } from 'react';\nimport { unstable_batchedUpdates } from 'react-dom';\nexport function createSingletonHandler(factory) {\n  const listeners = [];\n  const callback = value => {\n    unstable_batchedUpdates(() => {\n      for (const listener of listeners) {\n        listener(value);\n      }\n    });\n  };\n  let cleanup;\n  return function useSingleton(listener) {\n    useEffect(() => {\n      if (listeners.length === 0) {\n        cleanup = factory(callback);\n      }\n      listeners.push(listener);\n      return () => {\n        listeners.splice(listeners.indexOf(listener), 1);\n        if (listeners.length === 0) {\n          cleanup();\n          cleanup = undefined;\n        }\n      };\n      // register handlers only on mount\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n  };\n}\nexport function createSingletonState(_ref) {\n  let {\n    factory,\n    initialState\n  } = _ref;\n  const useSingleton = createSingletonHandler(factory);\n  let value = initialState;\n  return function useSingletonState() {\n    const [state, setState] = useState(value);\n    useSingleton(newValue => {\n      value = newValue;\n      setState(newValue);\n    });\n    return state;\n  };\n}","map":{"version":3,"names":["useEffect","useState","unstable_batchedUpdates","createSingletonHandler","factory","listeners","callback","value","listener","cleanup","useSingleton","length","push","splice","indexOf","undefined","createSingletonState","_ref","initialState","useSingletonState","state","setState","newValue"],"sources":["/Users/sohailsajid/Desktop/threat-modeling-app/node_modules/@cloudscape-design/component-toolkit/internal/singleton-handler/index.js"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { useEffect, useState } from 'react';\nimport { unstable_batchedUpdates } from 'react-dom';\nexport function createSingletonHandler(factory) {\n    const listeners = [];\n    const callback = value => {\n        unstable_batchedUpdates(() => {\n            for (const listener of listeners) {\n                listener(value);\n            }\n        });\n    };\n    let cleanup;\n    return function useSingleton(listener) {\n        useEffect(() => {\n            if (listeners.length === 0) {\n                cleanup = factory(callback);\n            }\n            listeners.push(listener);\n            return () => {\n                listeners.splice(listeners.indexOf(listener), 1);\n                if (listeners.length === 0) {\n                    cleanup();\n                    cleanup = undefined;\n                }\n            };\n            // register handlers only on mount\n            // eslint-disable-next-line react-hooks/exhaustive-deps\n        }, []);\n    };\n}\nexport function createSingletonState({ factory, initialState }) {\n    const useSingleton = createSingletonHandler(factory);\n    let value = initialState;\n    return function useSingletonState() {\n        const [state, setState] = useState(value);\n        useSingleton(newValue => {\n            value = newValue;\n            setState(newValue);\n        });\n        return state;\n    };\n}\n"],"mappings":"AAAA;AACA;AACA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,uBAAuB,QAAQ,WAAW;AACnD,OAAO,SAASC,sBAAsBA,CAACC,OAAO,EAAE;EAC5C,MAAMC,SAAS,GAAG,EAAE;EACpB,MAAMC,QAAQ,GAAGC,KAAK,IAAI;IACtBL,uBAAuB,CAAC,MAAM;MAC1B,KAAK,MAAMM,QAAQ,IAAIH,SAAS,EAAE;QAC9BG,QAAQ,CAACD,KAAK,CAAC;MACnB;IACJ,CAAC,CAAC;EACN,CAAC;EACD,IAAIE,OAAO;EACX,OAAO,SAASC,YAAYA,CAACF,QAAQ,EAAE;IACnCR,SAAS,CAAC,MAAM;MACZ,IAAIK,SAAS,CAACM,MAAM,KAAK,CAAC,EAAE;QACxBF,OAAO,GAAGL,OAAO,CAACE,QAAQ,CAAC;MAC/B;MACAD,SAAS,CAACO,IAAI,CAACJ,QAAQ,CAAC;MACxB,OAAO,MAAM;QACTH,SAAS,CAACQ,MAAM,CAACR,SAAS,CAACS,OAAO,CAACN,QAAQ,CAAC,EAAE,CAAC,CAAC;QAChD,IAAIH,SAAS,CAACM,MAAM,KAAK,CAAC,EAAE;UACxBF,OAAO,CAAC,CAAC;UACTA,OAAO,GAAGM,SAAS;QACvB;MACJ,CAAC;MACD;MACA;IACJ,CAAC,EAAE,EAAE,CAAC;EACV,CAAC;AACL;AACA,OAAO,SAASC,oBAAoBA,CAAAC,IAAA,EAA4B;EAAA,IAA3B;IAAEb,OAAO;IAAEc;EAAa,CAAC,GAAAD,IAAA;EAC1D,MAAMP,YAAY,GAAGP,sBAAsB,CAACC,OAAO,CAAC;EACpD,IAAIG,KAAK,GAAGW,YAAY;EACxB,OAAO,SAASC,iBAAiBA,CAAA,EAAG;IAChC,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGpB,QAAQ,CAACM,KAAK,CAAC;IACzCG,YAAY,CAACY,QAAQ,IAAI;MACrBf,KAAK,GAAGe,QAAQ;MAChBD,QAAQ,CAACC,QAAQ,CAAC;IACtB,CAAC,CAAC;IACF,OAAOF,KAAK;EAChB,CAAC;AACL","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}