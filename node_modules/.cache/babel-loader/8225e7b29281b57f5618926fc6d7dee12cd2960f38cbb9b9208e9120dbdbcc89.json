{"ast":null,"code":"import{useCallback}from'react';import useLocalStorageState from'use-local-storage-state';import{LOCAL_STORAGE_KEY_FLOW_INFO}from'../../../../configs/localStorageKeys';import removeLocalStorageKey from'../../../../utils/removeLocalStorageKey';import{FLOW_DEFAULT_VALUE}from'../../../constants';import{FlowContext}from'../../context';import{jsx as _jsx}from\"react/jsx-runtime\";const getLocalStorageKey=workspaceId=>{if(workspaceId){return`${LOCAL_STORAGE_KEY_FLOW_INFO}_${workspaceId}`;}return LOCAL_STORAGE_KEY_FLOW_INFO;};const FlowLocalStorageContextProvider=_ref=>{let{children,workspaceId:currentWorkspaceId}=_ref;const[flow,setFlow,{removeItem}]=useLocalStorageState(getLocalStorageKey(currentWorkspaceId),{defaultValue:FLOW_DEFAULT_VALUE});const handleRemoveFlow=useCallback(async()=>{removeItem();},[removeItem]);const handleDeleteWorkspace=useCallback(async workspaceId=>{window.setTimeout(()=>{// to delete after the workspace is switched. Otherwise the default value is set again.\nremoveLocalStorageKey(getLocalStorageKey(workspaceId));},1000);},[]);return/*#__PURE__*/_jsx(FlowContext.Provider,{value:{flow,setFlow,removeFlow:handleRemoveFlow,onDeleteWorkspace:handleDeleteWorkspace},children:children});};export default FlowLocalStorageContextProvider;","map":{"version":3,"names":["useCallback","useLocalStorageState","LOCAL_STORAGE_KEY_FLOW_INFO","removeLocalStorageKey","FLOW_DEFAULT_VALUE","FlowContext","jsx","_jsx","getLocalStorageKey","workspaceId","FlowLocalStorageContextProvider","_ref","children","currentWorkspaceId","flow","setFlow","removeItem","defaultValue","handleRemoveFlow","handleDeleteWorkspace","window","setTimeout","Provider","value","removeFlow","onDeleteWorkspace"],"sources":["/Users/sohailsajid/Desktop/threat-modeling-app/src/contexts/FlowContext/components/LocalStorageContextProvider/index.tsx"],"sourcesContent":["import { FC, PropsWithChildren, useCallback } from 'react';\nimport useLocalStorageState from 'use-local-storage-state';\nimport { LOCAL_STORAGE_KEY_FLOW_INFO } from '../../../../configs/localStorageKeys';\nimport { Flow } from '../../../../customTypes';\nimport removeLocalStorageKey from '../../../../utils/removeLocalStorageKey';\nimport { FLOW_DEFAULT_VALUE } from '../../../constants';\nimport { FlowContext } from '../../context';\nimport { FlowContextProviderProps } from '../../types';\n\nconst getLocalStorageKey = (workspaceId: string | null) => {\n  if (workspaceId) {\n    return `${LOCAL_STORAGE_KEY_FLOW_INFO}_${workspaceId}`;\n  }\n\n  return LOCAL_STORAGE_KEY_FLOW_INFO;\n};\n\nconst FlowLocalStorageContextProvider: FC<PropsWithChildren<FlowContextProviderProps>> = ({\n  children,\n  workspaceId: currentWorkspaceId,\n}) => {\n  const [flow, setFlow, { removeItem }] = useLocalStorageState<Flow>(getLocalStorageKey(currentWorkspaceId), {\n    defaultValue: FLOW_DEFAULT_VALUE,\n  });\n\n  const handleRemoveFlow = useCallback(async () => {\n    removeItem();\n  }, [removeItem]);\n\n  const handleDeleteWorkspace = useCallback(async (workspaceId: string) => {\n    window.setTimeout(() => {\n      // to delete after the workspace is switched. Otherwise the default value is set again.\n      removeLocalStorageKey(getLocalStorageKey(workspaceId));\n    }, 1000);\n  }, []);\n\n  return (<FlowContext.Provider value={{\n    flow,\n    setFlow,\n    removeFlow: handleRemoveFlow,\n    onDeleteWorkspace: handleDeleteWorkspace,\n  }}>\n    {children}\n  </FlowContext.Provider>);\n};\n\nexport default FlowLocalStorageContextProvider;\n\n"],"mappings":"AAAA,OAAgCA,WAAW,KAAQ,OAAO,CAC1D,MAAO,CAAAC,oBAAoB,KAAM,yBAAyB,CAC1D,OAASC,2BAA2B,KAAQ,sCAAsC,CAElF,MAAO,CAAAC,qBAAqB,KAAM,yCAAyC,CAC3E,OAASC,kBAAkB,KAAQ,oBAAoB,CACvD,OAASC,WAAW,KAAQ,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAG5C,KAAM,CAAAC,kBAAkB,CAAIC,WAA0B,EAAK,CACzD,GAAIA,WAAW,CAAE,CACf,MAAO,GAAGP,2BAA2B,IAAIO,WAAW,EAAE,CACxD,CAEA,MAAO,CAAAP,2BAA2B,CACpC,CAAC,CAED,KAAM,CAAAQ,+BAAgF,CAAGC,IAAA,EAGnF,IAHoF,CACxFC,QAAQ,CACRH,WAAW,CAAEI,kBACf,CAAC,CAAAF,IAAA,CACC,KAAM,CAACG,IAAI,CAAEC,OAAO,CAAE,CAAEC,UAAW,CAAC,CAAC,CAAGf,oBAAoB,CAAOO,kBAAkB,CAACK,kBAAkB,CAAC,CAAE,CACzGI,YAAY,CAAEb,kBAChB,CAAC,CAAC,CAEF,KAAM,CAAAc,gBAAgB,CAAGlB,WAAW,CAAC,SAAY,CAC/CgB,UAAU,CAAC,CAAC,CACd,CAAC,CAAE,CAACA,UAAU,CAAC,CAAC,CAEhB,KAAM,CAAAG,qBAAqB,CAAGnB,WAAW,CAAC,KAAO,CAAAS,WAAmB,EAAK,CACvEW,MAAM,CAACC,UAAU,CAAC,IAAM,CACtB;AACAlB,qBAAqB,CAACK,kBAAkB,CAACC,WAAW,CAAC,CAAC,CACxD,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAAE,EAAE,CAAC,CAEN,mBAAQF,IAAA,CAACF,WAAW,CAACiB,QAAQ,EAACC,KAAK,CAAE,CACnCT,IAAI,CACJC,OAAO,CACPS,UAAU,CAAEN,gBAAgB,CAC5BO,iBAAiB,CAAEN,qBACrB,CAAE,CAAAP,QAAA,CACCA,QAAQ,CACW,CAAC,CACzB,CAAC,CAED,cAAe,CAAAF,+BAA+B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}