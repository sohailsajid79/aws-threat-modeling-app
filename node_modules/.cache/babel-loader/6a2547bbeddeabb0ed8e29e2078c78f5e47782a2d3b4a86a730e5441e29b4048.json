{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useCallback, useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport { useMergeRefs } from '../../hooks/use-merge-refs';\nimport TabTrap from '../tab-trap/index';\nimport { getFirstFocusable, getLastFocusable } from './utils';\nfunction FocusLock({\n  className,\n  disabled,\n  autoFocus,\n  restoreFocus,\n  children\n}, ref) {\n  const returnFocusToRef = useRef(null);\n  const containerRef = useRef(null);\n  const focusFirst = () => {\n    var _a;\n    if (containerRef.current) {\n      (_a = getFirstFocusable(containerRef.current)) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n  };\n  const focusLast = () => {\n    var _a;\n    if (containerRef.current) {\n      (_a = getLastFocusable(containerRef.current)) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n  };\n  // Captures focus when `autoFocus` is set, and the component is mounted or\n  // `disabled` changes from true to false.\n  useEffect(() => {\n    if (autoFocus && !disabled) {\n      returnFocusToRef.current = document.activeElement;\n      focusFirst();\n    }\n  }, [autoFocus, disabled]);\n  // Restore focus if `restoreFocus` is set, and `disabled` changes from false\n  // to true.\n  const [previouslyDisabled, setPreviouslyDisabled] = useState(!!disabled);\n  useEffect(() => {\n    var _a;\n    if (previouslyDisabled !== !!disabled) {\n      setPreviouslyDisabled(!!disabled);\n      if (restoreFocus && disabled) {\n        (_a = returnFocusToRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n        returnFocusToRef.current = null;\n      }\n    }\n  }, [previouslyDisabled, disabled, restoreFocus]);\n  // Restore focus if `restoreFocus` is set and the component is unmounted.\n  // Using a callback ref for this is safer than using useEffect cleanups.\n  const restoreFocusHandler = useCallback(elem => {\n    var _a;\n    if (elem === null && restoreFocus) {\n      (_a = returnFocusToRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n      returnFocusToRef.current = null;\n    }\n  }, [restoreFocus]);\n  useImperativeHandle(ref, () => ({\n    focusFirst\n  }));\n  const mergedRef = useMergeRefs(containerRef, restoreFocusHandler);\n  return React.createElement(React.Fragment, null, React.createElement(TabTrap, {\n    disabled: disabled,\n    focusNextCallback: focusLast\n  }), React.createElement(\"div\", {\n    className: className,\n    ref: mergedRef\n  }, children), React.createElement(TabTrap, {\n    disabled: disabled,\n    focusNextCallback: focusFirst\n  }));\n}\nexport default React.forwardRef(FocusLock);","map":{"version":3,"names":["React","useCallback","useEffect","useImperativeHandle","useRef","useState","useMergeRefs","TabTrap","getFirstFocusable","getLastFocusable","FocusLock","className","disabled","autoFocus","restoreFocus","children","ref","returnFocusToRef","containerRef","focusFirst","current","_a","focus","focusLast","document","activeElement","previouslyDisabled","setPreviouslyDisabled","restoreFocusHandler","elem","mergedRef","createElement","Fragment","focusNextCallback","forwardRef"],"sources":["/Users/sohailsajid/Desktop/threat-modeling-app/node_modules/src/internal/components/focus-lock/index.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useCallback, useEffect, useImperativeHandle, useRef, useState } from 'react';\n\nimport { useMergeRefs } from '../../hooks/use-merge-refs';\nimport TabTrap from '../tab-trap/index';\nimport { getFirstFocusable, getLastFocusable } from './utils';\n\nexport interface FocusLockProps {\n  className?: string;\n  disabled?: boolean;\n  autoFocus?: boolean;\n  restoreFocus?: boolean;\n  children: React.ReactNode;\n}\n\nexport interface FocusLockRef {\n  /**\n   * Focuses the first element in the component.\n   */\n  focusFirst(): void;\n}\n\nfunction FocusLock(\n  { className, disabled, autoFocus, restoreFocus, children }: FocusLockProps,\n  ref: React.Ref<FocusLockRef>\n) {\n  const returnFocusToRef = useRef<HTMLOrSVGElement | null>(null);\n  const containerRef = useRef<HTMLDivElement | null>(null);\n\n  const focusFirst = () => {\n    if (containerRef.current) {\n      getFirstFocusable(containerRef.current)?.focus();\n    }\n  };\n\n  const focusLast = () => {\n    if (containerRef.current) {\n      getLastFocusable(containerRef.current)?.focus();\n    }\n  };\n\n  // Captures focus when `autoFocus` is set, and the component is mounted or\n  // `disabled` changes from true to false.\n  useEffect(() => {\n    if (autoFocus && !disabled) {\n      returnFocusToRef.current = document.activeElement as HTMLOrSVGElement | null;\n      focusFirst();\n    }\n  }, [autoFocus, disabled]);\n\n  // Restore focus if `restoreFocus` is set, and `disabled` changes from false\n  // to true.\n  const [previouslyDisabled, setPreviouslyDisabled] = useState(!!disabled);\n  useEffect(() => {\n    if (previouslyDisabled !== !!disabled) {\n      setPreviouslyDisabled(!!disabled);\n      if (restoreFocus && disabled) {\n        returnFocusToRef.current?.focus();\n        returnFocusToRef.current = null;\n      }\n    }\n  }, [previouslyDisabled, disabled, restoreFocus]);\n\n  // Restore focus if `restoreFocus` is set and the component is unmounted.\n  // Using a callback ref for this is safer than using useEffect cleanups.\n  const restoreFocusHandler = useCallback(\n    (elem: HTMLDivElement | null) => {\n      if (elem === null && restoreFocus) {\n        returnFocusToRef.current?.focus();\n        returnFocusToRef.current = null;\n      }\n    },\n    [restoreFocus]\n  );\n\n  useImperativeHandle(ref, () => ({ focusFirst }));\n  const mergedRef = useMergeRefs(containerRef, restoreFocusHandler);\n\n  return (\n    <>\n      <TabTrap disabled={disabled} focusNextCallback={focusLast} />\n      <div className={className} ref={mergedRef}>\n        {children}\n      </div>\n      <TabTrap disabled={disabled} focusNextCallback={focusFirst} />\n    </>\n  );\n}\n\nexport default React.forwardRef(FocusLock);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}