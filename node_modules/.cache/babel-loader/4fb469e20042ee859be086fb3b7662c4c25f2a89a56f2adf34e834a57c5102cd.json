{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { useEffect, useRef } from 'react';\nimport { getFirstFocusable, isFocusable } from '../components/focus-lock/utils.js';\nexport function useListFocusController({\n  nextFocusIndex,\n  onFocusMoved,\n  listItemSelector,\n  fallbackSelector,\n  showMoreSelector\n}) {\n  const tokenListRef = useRef(null);\n  useEffect(() => {\n    if (nextFocusIndex === undefined || nextFocusIndex === null || tokenListRef.current === null) {\n      return;\n    }\n    const tokenElements = tokenListRef.current.querySelectorAll(listItemSelector);\n    const fallbackElement = fallbackSelector ? selectElement(tokenListRef.current, fallbackSelector) : null;\n    const toggleButton = showMoreSelector ? selectElement(tokenListRef.current, showMoreSelector) : null;\n    let closestPrevIndex = Number.NEGATIVE_INFINITY;\n    let closestNextIndex = Number.POSITIVE_INFINITY;\n    for (let activeIndex = 0; activeIndex < tokenElements.length; activeIndex++) {\n      if (activeIndex < nextFocusIndex) {\n        closestPrevIndex = nextFocusIndex - activeIndex < nextFocusIndex - closestPrevIndex ? activeIndex : closestPrevIndex;\n      } else {\n        closestNextIndex = activeIndex - nextFocusIndex < closestNextIndex - nextFocusIndex ? activeIndex : closestNextIndex;\n      }\n    }\n    const nextElement = tokenElements[closestNextIndex];\n    const prevElement = tokenElements[closestPrevIndex];\n    const focusTarget = getFirstEligible({\n      id: 'next',\n      element: nextElement\n    }, {\n      id: 'prev',\n      element: prevElement\n    }, {\n      id: 'show-more',\n      element: toggleButton\n    }, {\n      id: 'fallback',\n      element: fallbackElement\n    });\n    if (focusTarget) {\n      onFocusMoved(focusTarget.element, focusTarget.id);\n    }\n    // Expecting onFocusMoved to be pure\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [nextFocusIndex, listItemSelector, fallbackSelector, showMoreSelector]);\n  return tokenListRef;\n}\nfunction getFirstEligible(...elements) {\n  for (const {\n    id,\n    element\n  } of elements) {\n    const focusable = element ? getFocusableElement(element) : null;\n    if (focusable) {\n      return {\n        id,\n        element: focusable\n      };\n    }\n  }\n  return null;\n}\nfunction getFocusableElement(element) {\n  if (!(element instanceof HTMLElement)) {\n    return null;\n  }\n  if (isFocusable(element)) {\n    return element;\n  }\n  return getFirstFocusable(element);\n}\nfunction selectElement(container, selector) {\n  if (container.matches(selector)) {\n    return container;\n  }\n  return container.querySelector(selector);\n}","map":{"version":3,"names":["useEffect","useRef","getFirstFocusable","isFocusable","useListFocusController","nextFocusIndex","onFocusMoved","listItemSelector","fallbackSelector","showMoreSelector","tokenListRef","undefined","current","tokenElements","querySelectorAll","fallbackElement","selectElement","toggleButton","closestPrevIndex","Number","NEGATIVE_INFINITY","closestNextIndex","POSITIVE_INFINITY","activeIndex","length","nextElement","prevElement","focusTarget","getFirstEligible","id","element","elements","focusable","getFocusableElement","HTMLElement","container","selector","matches","querySelector"],"sources":["/Users/sohailsajid/Desktop/threat-modeling-app/node_modules/src/internal/hooks/use-list-focus-controller.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport { useEffect, useRef } from 'react';\n\nimport { getFirstFocusable, isFocusable } from '../components/focus-lock/utils.js';\n\ninterface UseListFocusControllerOptions {\n  nextFocusIndex: null | number;\n  onFocusMoved: (target: HTMLElement, targetType: 'next' | 'prev' | 'show-more' | 'fallback') => void;\n  listItemSelector: string;\n  fallbackSelector?: string;\n  showMoreSelector?: string;\n}\n\nexport function useListFocusController({\n  nextFocusIndex,\n  onFocusMoved,\n  listItemSelector,\n  fallbackSelector,\n  showMoreSelector,\n}: UseListFocusControllerOptions) {\n  const tokenListRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (nextFocusIndex === undefined || nextFocusIndex === null || tokenListRef.current === null) {\n      return;\n    }\n\n    const tokenElements = tokenListRef.current.querySelectorAll(listItemSelector);\n    const fallbackElement = fallbackSelector ? selectElement(tokenListRef.current, fallbackSelector) : null;\n    const toggleButton = showMoreSelector ? selectElement(tokenListRef.current, showMoreSelector) : null;\n\n    let closestPrevIndex = Number.NEGATIVE_INFINITY;\n    let closestNextIndex = Number.POSITIVE_INFINITY;\n\n    for (let activeIndex = 0; activeIndex < tokenElements.length; activeIndex++) {\n      if (activeIndex < nextFocusIndex) {\n        closestPrevIndex =\n          nextFocusIndex - activeIndex < nextFocusIndex - closestPrevIndex ? activeIndex : closestPrevIndex;\n      } else {\n        closestNextIndex =\n          activeIndex - nextFocusIndex < closestNextIndex - nextFocusIndex ? activeIndex : closestNextIndex;\n      }\n    }\n\n    const nextElement = tokenElements[closestNextIndex];\n    const prevElement = tokenElements[closestPrevIndex];\n    const focusTarget = getFirstEligible(\n      { id: 'next', element: nextElement } as const,\n      { id: 'prev', element: prevElement } as const,\n      { id: 'show-more', element: toggleButton } as const,\n      { id: 'fallback', element: fallbackElement } as const\n    );\n\n    if (focusTarget) {\n      onFocusMoved(focusTarget.element, focusTarget.id);\n    }\n\n    // Expecting onFocusMoved to be pure\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [nextFocusIndex, listItemSelector, fallbackSelector, showMoreSelector]);\n\n  return tokenListRef;\n}\n\nfunction getFirstEligible<Key>(\n  ...elements: Array<{ id: Key; element: null | Element }>\n): null | { id: Key; element: HTMLElement } {\n  for (const { id, element } of elements) {\n    const focusable = element ? getFocusableElement(element) : null;\n    if (focusable) {\n      return { id, element: focusable };\n    }\n  }\n  return null;\n}\n\nfunction getFocusableElement(element: Element): null | HTMLElement {\n  if (!(element instanceof HTMLElement)) {\n    return null;\n  }\n  if (isFocusable(element)) {\n    return element;\n  }\n  return getFirstFocusable(element);\n}\n\nfunction selectElement(container: HTMLElement, selector: string): null | Element {\n  if (container.matches(selector)) {\n    return container;\n  }\n  return container.querySelector(selector);\n}\n"],"mappings":"AAAA;AACA;AAEA,SAASA,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAEzC,SAASC,iBAAiB,EAAEC,WAAW,QAAQ,mCAAmC;AAUlF,OAAM,SAAUC,sBAAsBA,CAAC;EACrCC,cAAc;EACdC,YAAY;EACZC,gBAAgB;EAChBC,gBAAgB;EAChBC;AAAgB,CACc;EAC9B,MAAMC,YAAY,GAAGT,MAAM,CAAiB,IAAI,CAAC;EAEjDD,SAAS,CAAC,MAAK;IACb,IAAIK,cAAc,KAAKM,SAAS,IAAIN,cAAc,KAAK,IAAI,IAAIK,YAAY,CAACE,OAAO,KAAK,IAAI,EAAE;MAC5F;;IAGF,MAAMC,aAAa,GAAGH,YAAY,CAACE,OAAO,CAACE,gBAAgB,CAACP,gBAAgB,CAAC;IAC7E,MAAMQ,eAAe,GAAGP,gBAAgB,GAAGQ,aAAa,CAACN,YAAY,CAACE,OAAO,EAAEJ,gBAAgB,CAAC,GAAG,IAAI;IACvG,MAAMS,YAAY,GAAGR,gBAAgB,GAAGO,aAAa,CAACN,YAAY,CAACE,OAAO,EAAEH,gBAAgB,CAAC,GAAG,IAAI;IAEpG,IAAIS,gBAAgB,GAAGC,MAAM,CAACC,iBAAiB;IAC/C,IAAIC,gBAAgB,GAAGF,MAAM,CAACG,iBAAiB;IAE/C,KAAK,IAAIC,WAAW,GAAG,CAAC,EAAEA,WAAW,GAAGV,aAAa,CAACW,MAAM,EAAED,WAAW,EAAE,EAAE;MAC3E,IAAIA,WAAW,GAAGlB,cAAc,EAAE;QAChCa,gBAAgB,GACdb,cAAc,GAAGkB,WAAW,GAAGlB,cAAc,GAAGa,gBAAgB,GAAGK,WAAW,GAAGL,gBAAgB;OACpG,MAAM;QACLG,gBAAgB,GACdE,WAAW,GAAGlB,cAAc,GAAGgB,gBAAgB,GAAGhB,cAAc,GAAGkB,WAAW,GAAGF,gBAAgB;;;IAIvG,MAAMI,WAAW,GAAGZ,aAAa,CAACQ,gBAAgB,CAAC;IACnD,MAAMK,WAAW,GAAGb,aAAa,CAACK,gBAAgB,CAAC;IACnD,MAAMS,WAAW,GAAGC,gBAAgB,CAClC;MAAEC,EAAE,EAAE,MAAM;MAAEC,OAAO,EAAEL;IAAW,CAAW,EAC7C;MAAEI,EAAE,EAAE,MAAM;MAAEC,OAAO,EAAEJ;IAAW,CAAW,EAC7C;MAAEG,EAAE,EAAE,WAAW;MAAEC,OAAO,EAAEb;IAAY,CAAW,EACnD;MAAEY,EAAE,EAAE,UAAU;MAAEC,OAAO,EAAEf;IAAe,CAAW,CACtD;IAED,IAAIY,WAAW,EAAE;MACfrB,YAAY,CAACqB,WAAW,CAACG,OAAO,EAAEH,WAAW,CAACE,EAAE,CAAC;;IAGnD;IACA;EACF,CAAC,EAAE,CAACxB,cAAc,EAAEE,gBAAgB,EAAEC,gBAAgB,EAAEC,gBAAgB,CAAC,CAAC;EAE1E,OAAOC,YAAY;AACrB;AAEA,SAASkB,gBAAgBA,CACvB,GAAGG,QAAqD;EAExD,KAAK,MAAM;IAAEF,EAAE;IAAEC;EAAO,CAAE,IAAIC,QAAQ,EAAE;IACtC,MAAMC,SAAS,GAAGF,OAAO,GAAGG,mBAAmB,CAACH,OAAO,CAAC,GAAG,IAAI;IAC/D,IAAIE,SAAS,EAAE;MACb,OAAO;QAAEH,EAAE;QAAEC,OAAO,EAAEE;MAAS,CAAE;;;EAGrC,OAAO,IAAI;AACb;AAEA,SAASC,mBAAmBA,CAACH,OAAgB;EAC3C,IAAI,EAAEA,OAAO,YAAYI,WAAW,CAAC,EAAE;IACrC,OAAO,IAAI;;EAEb,IAAI/B,WAAW,CAAC2B,OAAO,CAAC,EAAE;IACxB,OAAOA,OAAO;;EAEhB,OAAO5B,iBAAiB,CAAC4B,OAAO,CAAC;AACnC;AAEA,SAASd,aAAaA,CAACmB,SAAsB,EAAEC,QAAgB;EAC7D,IAAID,SAAS,CAACE,OAAO,CAACD,QAAQ,CAAC,EAAE;IAC/B,OAAOD,SAAS;;EAElB,OAAOA,SAAS,CAACG,aAAa,CAACF,QAAQ,CAAC;AAC1C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}