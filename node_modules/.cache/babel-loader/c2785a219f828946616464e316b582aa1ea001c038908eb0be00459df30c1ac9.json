{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { createContext, useCallback, useEffect, useLayoutEffect, useState } from 'react';\nimport { findUpUntil } from '@cloudscape-design/component-toolkit/dom';\nimport * as tokens from '../internal/generated/styles/tokens';\nimport { useMobile } from '../internal/hooks/use-mobile';\nimport globalVars from '../internal/styles/global-vars';\nimport { getOverflowParents } from '../internal/utils/scrollable-containers';\nexport function computeOffset({\n  isMobile,\n  __stickyOffset,\n  __mobileStickyOffset,\n  hasInnerOverflowParents,\n  __additionalOffset\n}) {\n  const localOffset = isMobile ? (__stickyOffset !== null && __stickyOffset !== void 0 ? __stickyOffset : 0) - (__mobileStickyOffset !== null && __mobileStickyOffset !== void 0 ? __mobileStickyOffset : 0) : __stickyOffset !== null && __stickyOffset !== void 0 ? __stickyOffset : 0;\n  if (hasInnerOverflowParents || __stickyOffset !== undefined) {\n    return `${localOffset}px`;\n  }\n  const globalOffset = `var(${globalVars.stickyVerticalTopOffset}, 0px)`;\n  return `calc(${globalOffset} + ${localOffset}px + ${__additionalOffset ? tokens.spaceScaledS : '0px'})`;\n}\nexport const StickyHeaderContext = createContext({\n  isStuck: false\n});\nexport const useStickyHeader = (rootRef, headerRef, __stickyHeader, __stickyOffset, __mobileStickyOffset, __disableMobile, __additionalOffset = false) => {\n  const isMobile = useMobile();\n  const disableSticky = isMobile && __disableMobile;\n  const isSticky = !disableSticky && !!__stickyHeader;\n  // If it has overflow parents inside the app layout, we shouldn't apply a sticky offset.\n  const [hasInnerOverflowParents, setHasInnerOverflowParents] = useState(false);\n  const [isStuck, setIsStuck] = useState(false);\n  useLayoutEffect(() => {\n    if (rootRef.current) {\n      const overflowParents = getOverflowParents(rootRef.current);\n      const mainElement = findUpUntil(rootRef.current, elem => elem.tagName === 'MAIN');\n      // In both versions of the app layout, the scrolling element for disableBodyScroll\n      // is the <main>. If the closest overflow parent is also the closest <main> and we have\n      // offset values, it's safe to assume that it's the app layout scroll root and we\n      // should stop there.\n      setHasInnerOverflowParents(overflowParents.length > 0 && overflowParents[0] !== mainElement);\n    }\n  }, [rootRef]);\n  const computedOffset = computeOffset({\n    isMobile,\n    __stickyOffset,\n    __mobileStickyOffset,\n    hasInnerOverflowParents,\n    __additionalOffset\n  });\n  const stickyStyles = isSticky ? {\n    style: {\n      top: computedOffset\n    }\n  } : {};\n  // \"stuck\" state, when the header has moved from its original posititon has a\n  // box-shadow, applied here by a \"header-stuck\" className\n  const checkIfStuck = useCallback(({\n    isTrusted,\n    target,\n    type\n  }) => {\n    if (type === 'resize' && target === window && !isTrusted) {\n      // The window size didn't actually change, it was a synthetic event\n      return;\n    }\n    if (rootRef.current && headerRef.current) {\n      const rootTopBorderWidth = parseFloat(getComputedStyle(rootRef.current).borderTopWidth) || 0;\n      const rootTop = rootRef.current.getBoundingClientRect().top + rootTopBorderWidth;\n      const headerTop = headerRef.current.getBoundingClientRect().top;\n      if (rootTop < headerTop) {\n        setIsStuck(true);\n      } else {\n        setIsStuck(false);\n      }\n    }\n  }, [rootRef, headerRef]);\n  useEffect(() => {\n    if (isSticky) {\n      window.addEventListener('scroll', checkIfStuck, true);\n      window.addEventListener('resize', checkIfStuck);\n      return () => {\n        window.removeEventListener('scroll', checkIfStuck, true);\n        window.removeEventListener('resize', checkIfStuck);\n      };\n    }\n  }, [isSticky, checkIfStuck]);\n  return {\n    isSticky,\n    isStuck,\n    stickyStyles\n  };\n};","map":{"version":3,"names":["createContext","useCallback","useEffect","useLayoutEffect","useState","findUpUntil","tokens","useMobile","globalVars","getOverflowParents","computeOffset","isMobile","__stickyOffset","__mobileStickyOffset","hasInnerOverflowParents","__additionalOffset","localOffset","undefined","globalOffset","stickyVerticalTopOffset","spaceScaledS","StickyHeaderContext","isStuck","useStickyHeader","rootRef","headerRef","__stickyHeader","__disableMobile","disableSticky","isSticky","setHasInnerOverflowParents","setIsStuck","current","overflowParents","mainElement","elem","tagName","length","computedOffset","stickyStyles","style","top","checkIfStuck","isTrusted","target","type","window","rootTopBorderWidth","parseFloat","getComputedStyle","borderTopWidth","rootTop","getBoundingClientRect","headerTop","addEventListener","removeEventListener"],"sources":["/Users/sohailsajid/Desktop/threat-modeling-app/node_modules/src/container/use-sticky-header.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { createContext, RefObject, useCallback, useEffect, useLayoutEffect, useState } from 'react';\n\nimport { findUpUntil } from '@cloudscape-design/component-toolkit/dom';\n\nimport * as tokens from '../internal/generated/styles/tokens';\nimport { useMobile } from '../internal/hooks/use-mobile';\nimport globalVars from '../internal/styles/global-vars';\nimport { getOverflowParents } from '../internal/utils/scrollable-containers';\n\ninterface StickyHeaderContextProps {\n  isStuck: boolean;\n}\n\ninterface ComputeOffsetProps {\n  isMobile: boolean;\n  __stickyOffset?: number;\n  __mobileStickyOffset?: number;\n  hasInnerOverflowParents: boolean;\n  __additionalOffset?: boolean;\n}\n\nexport function computeOffset({\n  isMobile,\n  __stickyOffset,\n  __mobileStickyOffset,\n  hasInnerOverflowParents,\n  __additionalOffset,\n}: ComputeOffsetProps): string {\n  const localOffset = isMobile ? (__stickyOffset ?? 0) - (__mobileStickyOffset ?? 0) : __stickyOffset ?? 0;\n  if (hasInnerOverflowParents || __stickyOffset !== undefined) {\n    return `${localOffset}px`;\n  }\n  const globalOffset = `var(${globalVars.stickyVerticalTopOffset}, 0px)`;\n\n  return `calc(${globalOffset} + ${localOffset}px + ${__additionalOffset ? tokens.spaceScaledS : '0px'})`;\n}\n\nexport const StickyHeaderContext = createContext<StickyHeaderContextProps>({\n  isStuck: false,\n});\n\nexport const useStickyHeader = (\n  rootRef: RefObject<HTMLDivElement>,\n  headerRef: RefObject<HTMLDivElement>,\n  __stickyHeader?: boolean,\n  __stickyOffset?: number,\n  __mobileStickyOffset?: number,\n  __disableMobile?: boolean,\n  __additionalOffset = false\n) => {\n  const isMobile = useMobile();\n  const disableSticky = isMobile && __disableMobile;\n  const isSticky = !disableSticky && !!__stickyHeader;\n\n  // If it has overflow parents inside the app layout, we shouldn't apply a sticky offset.\n  const [hasInnerOverflowParents, setHasInnerOverflowParents] = useState(false);\n  const [isStuck, setIsStuck] = useState(false);\n  useLayoutEffect(() => {\n    if (rootRef.current) {\n      const overflowParents = getOverflowParents(rootRef.current);\n      const mainElement = findUpUntil(rootRef.current, elem => elem.tagName === 'MAIN');\n      // In both versions of the app layout, the scrolling element for disableBodyScroll\n      // is the <main>. If the closest overflow parent is also the closest <main> and we have\n      // offset values, it's safe to assume that it's the app layout scroll root and we\n      // should stop there.\n      setHasInnerOverflowParents(overflowParents.length > 0 && overflowParents[0] !== mainElement);\n    }\n  }, [rootRef]);\n\n  const computedOffset = computeOffset({\n    isMobile,\n    __stickyOffset,\n    __mobileStickyOffset,\n    hasInnerOverflowParents,\n    __additionalOffset,\n  });\n\n  const stickyStyles = isSticky\n    ? {\n        style: {\n          top: computedOffset,\n        },\n      }\n    : {};\n\n  // \"stuck\" state, when the header has moved from its original posititon has a\n  // box-shadow, applied here by a \"header-stuck\" className\n  const checkIfStuck = useCallback(\n    ({ isTrusted, target, type }) => {\n      if (type === 'resize' && target === window && !isTrusted) {\n        // The window size didn't actually change, it was a synthetic event\n        return;\n      }\n      if (rootRef.current && headerRef.current) {\n        const rootTopBorderWidth = parseFloat(getComputedStyle(rootRef.current).borderTopWidth) || 0;\n        const rootTop = rootRef.current.getBoundingClientRect().top + rootTopBorderWidth;\n        const headerTop = headerRef.current.getBoundingClientRect().top;\n\n        if (rootTop < headerTop) {\n          setIsStuck(true);\n        } else {\n          setIsStuck(false);\n        }\n      }\n    },\n    [rootRef, headerRef]\n  );\n  useEffect(() => {\n    if (isSticky) {\n      window.addEventListener('scroll', checkIfStuck, true);\n      window.addEventListener('resize', checkIfStuck);\n      return () => {\n        window.removeEventListener('scroll', checkIfStuck, true);\n        window.removeEventListener('resize', checkIfStuck);\n      };\n    }\n  }, [isSticky, checkIfStuck]);\n  return {\n    isSticky,\n    isStuck,\n    stickyStyles,\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}